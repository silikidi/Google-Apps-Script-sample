/*********************************************************
 * Simpan ke file Code.gs
 * EKSPERIMEN #3 *
 * Menyimpan ke Google Sheets dan Tampilkan Dalam HTML
 * HTML, CSS dan JS dipisahkan tersendiri untuk memudahkan
**********************************************************/

const googleWebAppURL = "https://script.google.com/macros/s/AKfycbxvl4jXsnp48W38v1Z34rpJSmZXuDeZZ2NyV8nw0sP5DS54gN7EKXXnBdpL2duK36LOFw/exec";
const googleSheetID = "1xCrYKgONnHHZX0nXKvq18Js4a_wo00HGOZF9U8P8OCw";

function doGet(e) {
  
  var parameterToko = e.parameter;
  
  var produk = parameterToko.produk;
  var warna = parameterToko.warna;
  var harga = parameterToko.harga;
  var toko = parameterToko.toko;

  /**************************
  * SIMPAN KE GOOGLE SHEETS *
  ***************************/
  var namaSheet = "DATA";
  var sheet = SpreadsheetApp.openById(googleSheetID).getSheetByName(namaSheet);
  sheet.appendRow([ produk, warna, harga, toko ]);

  /**************************
  * TAMPILKAN KE LAMAN HTML *
  ***************************/
  return HtmlService.createTemplateFromFile("Code-page").evaluate();

}


/***********************************
 * FUNGSI UNTUK MENYISIPKAN CSS JS *
************************************/
function include(filename) {
  return HtmlService.createHtmlOutputFromFile(filename).getContent();
}
